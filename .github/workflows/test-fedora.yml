name: Test Fedora Server
on: [push]

jobs:
  test-prod:
    # C'est ICI que la magie opère : on cible ton serveur, pas le cloud
    runs-on: self-hosted
    
    steps:
      - name: Checkout du code
        uses: actions/checkout@v4

      - name: Vérifier l'hôte
        run: |
          echo "Je tourne sur : $(hostname)"
          echo "OS : $(cat /etc/fedora-release)"
          echo "Kernel : $(uname -r)"

      - name: Installation de uv (si absent)
        run: |
          if ! command -v uv &> /dev/null; then
              curl -LsSf https://astral.sh/uv/install.sh | sh
          fi

      - name: Créer un venv et tester Python
        run: |
          # uv est ultra rapide
          uv venv
          uv run python3 -c "import sys; print(f'Succès ! Python {sys.version} tourne sur le serveur.')"